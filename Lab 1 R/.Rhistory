# or to read this from an excel file
install.packages("gdata")
library(gdata)
ni.db.excel <- read.xls(xls = "../ni.2789.clinical.xls",
sheet = 1)
ni.db.excel <- read.xls(xls = "./ni.2789.clinical.xls",
sheet = 1)
View(ni.db.excel)
# Before reading in your data, it is useful to know
# you working directory
getwd()
# Before reading in your data, it is useful to know
# you working directory
getwd()
# Before reading in your data, it is useful to know
# you working directory
getwd()
# To read this dataset we will use the read.csv() fucntion in R
# Use ?read.csv or help(read.csv) to learn more about that function
?read.csv
ni.db <- read.csv(file = "./ni.2789.clinical.csv",
stringsAsFactors  =  FALSE)
View(ni.db)
View(ni.db)
# or to read this from an excel file
install.packages("gdata")
?read.xls
library(gdata)
?read.xls
ni.db.excel <- read.xls(xls = "./ni.2789.clinical.xls",
sheet = 1)
View(ni.db.excel)
# What is the class of ni.db
class(ni.db)
# What is the structure of ni.db
str(ni.db)
# How many rows and columns are in ni.db
dim(ni.db)
##### 2. Creating vectors -----
## Creating a new vector
tas <- c("Sally","Kelly", "Catherine")
# How many elements are in this vector
tas
# Accessing the 1st element
tas[1]
## Creating a new vector from a column of a data.frame
age <- ni.db$Age
length(age)
age[1:10]  # you can specify a range of elements
age
##### 3. Accessing the elements of the data.frame -----
colnames(ni.db)
ni.db$Age     # variable can be called by its name with $ operator
##### 4. Exploring the structure of your data -----
class(ni.db)    # class of the R object (ie, data.frame/matrix/list/vector)
ni.db[1:7, 1:5]  # first 7 observations and 5 variables
summary(ni.db)  # quick summary of all data
summary(ni.db[, 1:5])  # quick summary of first 5 variables
mmary(ni.db[, c("Age", "IgG1A")])  # summary of 2 selected variables
summary(ni.db[, c("Age", "IgG1A")])  # summary of 2 selected variables
##### 5. Adding / changing variables -----
install.packages("plyr")
library(plyr)
?mutate
ni.db <- mutate(ni.db, ageF  =  ifelse(Age < 33, "<33", "> = 33"),
Researcher  =  "Maria")
View(ni.db)
head(ni.db[, c("Subject", "Age", "ageF", "Researcher")])
##### 6. Subsetting data -----
# Keeping only day0
ni.db.D0 <- subset(ni.db, Visit == "day0")
View(ni.db.D0)
dim(ni.db.D0)
ni.db.D0[1:5, 1:10]
##### 7. Descriptive statistics -----
### 7.1. Continuous Data -----
# Age at Day0
hist(ni.db.D0$Age, col = 'dodgerblue')
##### 7. Descriptive statistics -----
### 7.1. Continuous Data -----
# Age at Day0
hist(ni.db.D0$Age, col = 'dodgerblue')
##### 7. Descriptive statistics -----
### 7.1. Continuous Data -----
# Age at Day0
hist(ni.db.D0$age, col = 'dodgerblue')
##### 7. Descriptive statistics -----
### 7.1. Continuous Data -----
# Age at Day0
# hist(ni.db.D0$Age, col = 'dodgerblue')
qqnorm(ni.db.D0$Age)
##### 7. Descriptive statistics -----
### 7.1. Continuous Data -----
# Age at Day0
# hist(ni.db.D0$Age, col = 'dodgerblue')
# qqnorm(ni.db.D0$Age)
summary(ni.db.D0$Age, na.rm = T)  # if data has missing values need to specify na.rm = T
median(ni.db.D0$Age, na.rm = T)
mean(ni.db.D0$Age,na.rm = T)
sd(ni.db.D0$Age, na.rm = T)
var(ni.db.D0$Age, na.rm = T)
library(moments)  # this package has skewness and kurtosis functions
skewness(ni.db.D0$Age, na.rm = T)
kurtosis(ni.db.D0$Age, na.rm = T)
# get statistcs by group:
# check if distribution differ by baby's sex
by(ni.db.D0[, c("Age", "IgG1A", "SBA.titerA")], ni.db.D0$Gender, summary)
### 7.2. Categorical Data -----
# One-way tables
table(ni.db.D0$Gender)
prop.table(table(ni.db.D0$Gender))
barplot(table(ni.db.D0$Gender))
########################### GGPLOT2 ###########################
boxplot(IgMC ~ Vaccine, data = ni.db.D0)
####### Basic Boxplot
library(ggplot2)
ggplot(ni.db.D0, aes(x = Vaccine, y = IgMC)) +
geom_boxplot()
####### Pretty Boxplot
ggplot(ni.db.D0, aes(x = Vaccine, y = IgMC, fill = Vaccine)) +
geom_boxplot() +
stat_summary(fun.y = mean, colour = "red", geom = "point",
shape = 18, size = 4, show.legend = F) +
scale_fill_manual(values = c("gold", "forestgreen")) +
labs(title = "Distribution of IgMC by Vaccine", x = "") +
theme_bw()
